<!DOCTYPE html>
<html lang="en">

{% load static %}

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Treeo</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet"
		integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
	<style>
body {
  margin: 0 auto;
  max-width: 800px;
  padding: 0 20px;
}

.container {
overflow-wrap: break-word;
  border: 2px solid #dedede;
  background-color: #f1f1f1;
  border-radius: 5px;
  padding: 10px;
  margin: 10px 0;
}

.darker {
overflow-wrap: break-word;
  border-color: #ccc;
  background-color: #ddd;
}

.container::after {
  content: "";
  clear: both;
  display: table;
}

.container img {
  float: left;
  max-width: 60px;
  width: 100%;
  margin-right: 20px;
  border-radius: 50%;
}

.container img.right {
  float: right;
  margin-left: 20px;
  margin-right:0;
}

.time-right {
  float: right;
  color: #aaa;
}

.time-left {
  float: left;
  color: #999;
}
    /* Create two equal columns that floats next to each other */
.column {
  float: left;
  width: 20%;
  padding: 10px;
  height: 300px; /* Should be removed. Only for demonstration */
}

.column2 {
  float: left;
  width: 80%;
  padding: 10px;
  height: 300px; /* Should be removed. Only for demonstration */
}
/* Clear floats after the columns */
.row:after {
  content: "";
  display: table;
  clear: both;
}
</style>

</head>
<div id="wrapper">
	<div id="navwrapper">
		<nav class="navbar navbar-expand">
			&nbsp;<a href="{% url 'home' %}">Home</a>
			<a href="{% url 'reqAppt' %}">Appointments</a>
			<a href="{% url 'patientlog' %}">Patient Log</a>
			<a href="{% url 'upload_download_file_upload' %}">File Upload</a>
			<a href="{% url 'upload_download_file_download' %}">File Download</a>
			<a href="{% url 'profile' %}">Account Details</a>
			<!--	<a href="{% url 'register' %}">Inbox</a>-->
			<a href="{% url 'logout' %}">Logout</a>
		</nav>
	</div>

		</div>

<!--<table>-->
<!--    <thead>-->
<!--        <tr><th>Sender</th><th>Subject</th><th>Received</th><th>Status</th><th>Reply</th></tr>-->
<!--        <tr>-->
<!--        <td>{{ message.sender.username }}</td>-->
<!--        <td>{{ message.subject }}</td>-->
<!--        <td>{{ message.send_time|date:_("DATETIME_FORMAT") }}</td>-->
<!--        <td>{{ message.read_status }}</td>-->
<!--        <td>{{ message.read_status }}</td>-->
<!--    </tr>-->
<!--    </thead>-->
<!--    <tbody>-->
<!--     </tbody>-->
<!--</table>   -->

<h1>Inbox</h1>

  <div class="column" style="background-color:#bbb;">
    <h2>Convos</h2>
    <p>Some Convo ids..</p>
<!--	  {% if message_list.convo_list %}-->
<!--{% for convo in message_list.convo_list %}-->
<!--	  <div class="container">-->
<!--  <img src="/w3images/bandmember.jpg" alt={{ convo.names }}>-->
<!--  <p>{{ convo.unread }}</p>-->
<!--  <span class="time-right">{{ convo.last_time|date:_("DATETIME_FORMAT") }}</span>-->
<!--</div>-->
<!--{% endfor %}-->
<!--	  {% else %}-->
<!--<p>No Conversations</p>-->
<!--{% endif %}-->
  </div>
</div>
<div class="row">
  <div class="column2" style="background-color:#aaa;">

<!--<table>-->
<!--    <thead>-->
<!--        <tr><th>Sender</th><th>Subject</th><th>Received</th><th>Status</th><th>Reply</th></tr>-->
<!--        <tr>-->
<!--        <td>{{ message.sender.username }}</td>-->
<!--        <td>{{ message.subject }}</td>-->
<!--        <td>{{ message.send_time|date:_("DATETIME_FORMAT") }}</td>-->
<!--        <td>{{ message.read_status }}</td>-->
<!--        <td>{{ message.read_status }}</td>-->
<!--    </tr>-->
<!--    </thead>-->
<!--    <tbody>-->
<!--     </tbody>-->
<!--</table>   -->
<!--    messagelist.convos and message.messagelist-->

{% if message_list %}
{% for message in message_list %}
{% if message.sender.username == user.username %}
 <div class="container">
  <img src="/w3images/bandmember.jpg" alt= "{{message.sender.username}}">
	 <br>
	{% if message.perm_del == 1 %}
		<p>Message Deleted</p>
		<a href="{% url 'messaging_undelete' message.id %}"> Undelete</a>
	{% else %}
	<p>{{ message.msgbody }}</p>
	 <a href="{% url 'messaging_delete' message.id %}"> Delete</a>
	 {% endif %}
  <span class="time-right">{{ message.send_time|date:_("DATETIME_FORMAT") }}</span>
	 {% if message.read_status == 1 %}
		<p>Delivered</p>
	 {% endif %}
</div>
{% else %}
<div class="container darker">
  <img src="/w3images/avatar_g2.jpg" alt= "{{message.sender.username}}" class="right">
	<br>
	{% if message.perm_del == 1 %}
		<p>Message Deleted</p>
	{% else %}
	<p>{{ message.msgbody }}</p>
	 {% endif %}
  <span class="time-left">{{ message.send_time|date:_("DATETIME_FORMAT") }}</span>
</div>
{% endif %}
{% endfor %}
<!--      use a form here-->
<form method="post">{% csrf_token %}
  <label for="fname">Type Message Here:</label>
  <input type="text" id="new_message" name="new_message"><br><br>
    </form>
{% else %}
<p>No Messages</p>
{% endif %}
  </div>